<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>نظام إدارة المحتوى التعليمي</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            },
            secondary: {
              50: '#f5f3ff',
              100: '#ede9fe',
              200: '#ddd6fe',
              300: '#c4b5fd',
              400: '#a78bfa',
              500: '#8b5cf6',
              600: '#7c3aed',
              700: '#6d28d9',
              800: '#5b21b6',
              900: '#4c1d95',
            },
            dark: {
              50: '#f8fafc',
              100: '#f1f5f9',
              200: '#e2e8f0',
              300: '#cbd5e1',
              400: '#94a3b8',
              500: '#64748b',
              600: '#475569',
              700: '#334155',
              800: '#1e293b',
              900: '#0f172a',
            }
          },
          boxShadow: {
            'glass': '0 4px 30px rgba(0, 0, 0, 0.1)',
            'neumorphism': '8px 8px 16px #d1d9e6, -8px -8px 16px #ffffff',
            'card': '0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)'
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'pulse-slow': 'pulse 6s infinite',
            'spin-slow': 'spin 3s linear infinite'
          }
        }
      }
    }
  </script>
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      min-height: 100vh;
    }
    
    .glass-card {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px) saturate(180%);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05);
    }
    
    .gradient-text {
      background: linear-gradient(90deg, #0ea5e9 0%, #8b5cf6 100%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    
    .progress-bar {
      height: 8px;
      background: linear-gradient(90deg, #0ea5e9 0%, #8b5cf6 100%);
      border-radius: 4px;
      transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .tab-content {
      display: none;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.4s ease;
    }
    
    .tab-content.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%);
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(79, 70, 229, 0.2);
    }
    
    .btn-primary:hover {
      background: linear-gradient(135deg, #0284c7 0%, #7c3aed 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(79, 70, 229, 0.3);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .input-field {
      transition: all 0.3s ease;
      border: 1px solid #e2e8f0;
    }
    
    .input-field:focus {
      border-color: #0ea5e9;
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.2);
    }
    
    .content-type-card {
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    
    .content-type-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    .content-type-card.selected {
      border-color: #0ea5e9;
      background-color: rgba(14, 165, 233, 0.05);
    }
    
    .floating-shape {
      position: absolute;
      border-radius: 50%;
      filter: blur(60px);
      opacity: 0.2;
      z-index: -1;
    }
    
    .shape-1 {
      width: 300px;
      height: 300px;
      background: linear-gradient(45deg, #0ea5e9, #8b5cf6);
      top: -100px;
      right: -100px;
      animation: float 8s ease-in-out infinite;
    }
    
    .shape-2 {
      width: 200px;
      height: 200px;
      background: linear-gradient(45deg, #8b5cf6, #ec4899);
      bottom: -50px;
      left: -50px;
      animation: float 10s ease-in-out infinite reverse;
    }
    
    .loader {
      width: 48px;
      height: 48px;
      border: 5px solid #e2e8f0;
      border-bottom-color: #0ea5e9;
      border-radius: 50%;
      display: inline-block;
      box-sizing: border-box;
      animation: rotation 1s linear infinite;
    }
    
    @keyframes rotation {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
  </style>
</head>
<body class="min-h-screen p-4 md:p-8 relative overflow-x-hidden">
  <!-- Floating background shapes -->
  <div class="floating-shape shape-1"></div>
  <div class="floating-shape shape-2"></div>
  
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-10">
      <div class="inline-block bg-white/50 backdrop-blur-md rounded-full p-3 mb-4 shadow-lg">
        <div class="bg-gradient-to-r from-primary-500 to-secondary-500 p-3 rounded-full text-white">
          <i class="fas fa-graduation-cap text-2xl"></i>
        </div>
      </div>
      <h1 class="text-4xl md:text-5xl font-black text-dark-800 mb-3">
        <span class="gradient-text">نظام إدارة المحتوى التعليمي</span>
      </h1>
      <p class="text-lg text-dark-600 max-w-2xl mx-auto">
        منصة متكاملة لإدارة المحتوى التعليمي باحترافية وسهولة
      </p>
    </div>

    <!-- Tabs Navigation -->
    <div class="flex items-center justify-center mb-8 bg-white/50 backdrop-blur-md rounded-full p-1 shadow-sm max-w-2xl mx-auto">
      <div class="flex space-x-1 space-x-reverse">
        <button class="tab-btn px-6 py-2 font-bold text-dark-500 hover:text-primary-600 rounded-full transition-all duration-300" data-tab="lectures-tab">
          <i class="fas fa-chalkboard-teacher mr-2"></i> المحاضرات
        </button>
        <button class="tab-btn px-6 py-2 font-bold text-dark-500 hover:text-primary-600 rounded-full transition-all duration-300" data-tab="add-lecture-tab">
          <i class="fas fa-plus-circle mr-2"></i> إضافة محاضرة
        </button>
        <button class="tab-btn px-6 py-2 font-bold text-dark-500 hover:text-primary-600 rounded-full transition-all duration-300" data-tab="add-content-tab">
          <i class="fas fa-file-alt mr-2"></i> إضافة محتوى
        </button>
      </div>
    </div>

    <!-- Lectures Tab -->
    <div id="lectures-tab" class="tab-content active">
      <div class="glass-card shadow-2xl p-6 md:p-8 space-y-8">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between border-b border-gray-200 pb-6 gap-4">
          <div>
            <h2 class="text-2xl md:text-3xl font-black text-dark-800">
              <i class="fas fa-list-ol mr-3 text-primary-500"></i> قائمة المحاضرات
            </h2>
            <p class="text-dark-500 mt-1">إدارة وعرض جميع المحاضرات المتاحة</p>
          </div>
          <div class="flex items-center space-x-2 space-x-reverse">
            <span id="lecturesCount" class="px-3 py-1 rounded-full text-sm font-bold bg-primary-100 text-primary-800">
              <span id="lecturesCountNumber">0</span> محاضرة
            </span>
            <button id="refreshLectures" class="p-2 bg-white rounded-full shadow hover:bg-gray-50 transition">
              <i class="fas fa-sync-alt text-dark-500"></i>
            </button>
          </div>
        </div>

        <!-- Filter Section -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div>
            <label class="block text-sm font-bold text-dark-700 mb-2">الصف الدراسي</label>
            <select id="filterStage" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500">
              <option value="">كل الصفوف</option>
              <option value="الصف الأول">الصف الأول</option>
              <option value="الصف الثاني">الصف الثاني</option>
              <option value="الصف الثالث">الصف الثالث</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-bold text-dark-700 mb-2">الكورس التعليمي</label>
            <select id="filterCourse" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" disabled>
              <option value="">كل الكورسات</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-bold text-dark-700 mb-2">تاريخ الإضافة</label>
            <select id="filterDate" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500">
              <option value="">الكل</option>
              <option value="day">آخر 24 ساعة</option>
              <option value="week">آخر أسبوع</option>
              <option value="month">آخر شهر</option>
            </select>
          </div>
          
          <div class="flex items-end">
            <button id="filterBtn" class="btn-primary w-full text-white py-3 px-6 rounded-xl flex items-center justify-center">
              <i class="fas fa-filter mr-2"></i> تصفية النتائج
            </button>
          </div>
        </div>

        <!-- Lectures Table -->
        <div class="overflow-x-auto rounded-xl border border-gray-200 bg-white shadow-sm">
          <table class="w-full border-collapse">
            <thead class="bg-gradient-to-r from-primary-50 to-secondary-50">
              <tr>
                <th class="p-4 text-right font-bold text-dark-700">عنوان المحاضرة</th>
                <th class="p-4 text-right font-bold text-dark-700">الصف</th>
                <th class="p-4 text-right font-bold text-dark-700">الكورس</th>
                <th class="p-4 text-center font-bold text-dark-700">المحتوى</th>
                <th class="p-4 text-center font-bold text-dark-700">الإجراءات</th>
              </tr>
            </thead>
            <tbody id="lecturesTableBody" class="divide-y divide-gray-200">
              <!-- سيتم ملؤها بالبيانات -->
            </tbody>
          </table>
        </div>

        <!-- Loading Indicator -->
        <div id="lecturesLoading" class="text-center py-12">
          <div class="loader mx-auto"></div>
          <p class="mt-4 text-dark-600 font-medium">جاري تحميل المحاضرات...</p>
        </div>
        
        <!-- Empty State -->
        <div id="lecturesEmpty" class="hidden text-center py-12">
          <div class="mx-auto bg-primary-100 w-20 h-20 rounded-full flex items-center justify-center mb-4">
            <i class="fas fa-folder-open text-3xl text-primary-600"></i>
          </div>
          <h3 class="text-xl font-bold text-dark-800 mb-2">لا توجد محاضرات متاحة</h3>
          <p class="text-dark-500 max-w-md mx-auto">يمكنك البدء بإضافة محاضرة جديدة باستخدام زر "إضافة محاضرة" بالأعلى</p>
        </div>
      </div>
    </div>

    <!-- Add Lecture Tab -->
    <div id="add-lecture-tab" class="tab-content">
      <div class="glass-card shadow-2xl p-6 md:p-8 space-y-8">
        <div class="flex items-center justify-between border-b border-gray-200 pb-6">
          <div>
            <h2 class="text-2xl md:text-3xl font-black text-dark-800">
              <i class="fas fa-plus-circle mr-3 text-primary-500"></i> إضافة محاضرة جديدة
            </h2>
            <p class="text-dark-500 mt-1">املأ النموذج لإضافة محاضرة جديدة للنظام</p>
          </div>
          <div class="bg-primary-100 text-primary-800 px-3 py-1 rounded-full text-sm font-bold">
            <i class="fas fa-lightbulb mr-1"></i> جديد
          </div>
        </div>

        <form id="lectureForm" class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-bold text-dark-700 mb-2">الصف الدراسي <span class="text-red-500">*</span></label>
              <select id="lectureStage" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" required>
                <option value="" disabled selected>اختر الصف الدراسي</option>
                <option value="الصف الأول">الصف الأول</option>
                <option value="الصف الثاني">الصف الثاني</option>
                <option value="الصف الثالث">الصف الثالث</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-bold text-dark-700 mb-2">الكورس التعليمي <span class="text-red-500">*</span></label>
              <select id="lectureCourse" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" disabled required>
                <option value="" disabled selected>اختر الكورس</option>
              </select>
            </div>
          </div>

          <div>
            <label class="block text-sm font-bold text-dark-700 mb-2">عنوان المحاضرة <span class="text-red-500">*</span></label>
            <input type="text" id="lectureTitle" placeholder="أدخل عنوان المحاضرة" required 
                   class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" />
          </div>

          <div>
            <label class="block text-sm font-bold text-dark-700 mb-2">وصف المحاضرة</label>
            <textarea id="lectureDescription" rows="4" placeholder="أدخل وصفاً للمحاضرة"
                   class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500"></textarea>
          </div>

          <div class="pt-4">
            <button type="submit" id="saveLectureBtn" 
                    class="btn-primary w-full text-white py-4 px-6 rounded-xl hover:shadow-lg transition-all duration-300 flex items-center justify-center">
              <i class="fas fa-save mr-3"></i> حفظ المحاضرة الجديدة
            </button>
          </div>
        </form>

        <!-- Success Message -->
        <div id="lectureSuccessMsg" class="hidden p-6 bg-green-50 rounded-xl border-l-4 border-green-500">
          <div class="flex items-start">
            <div class="flex-shrink-0">
              <i class="fas fa-check-circle text-2xl text-green-500 mt-1"></i>
            </div>
            <div class="mr-3 flex-1">
              <h3 class="font-bold text-green-800">تم بنجاح!</h3>
              <p class="mt-1 text-sm text-green-700" id="lectureSuccessText"></p>
            </div>
            <button id="closeLectureSuccess" class="text-green-500 hover:text-green-700">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Content Tab -->
    <div id="add-content-tab" class="tab-content">
      <div class="glass-card shadow-2xl p-6 md:p-8 space-y-8">
        <div class="flex items-center justify-between border-b border-gray-200 pb-6">
          <div>
            <h2 class="text-2xl md:text-3xl font-black text-dark-800">
              <i class="fas fa-file-alt mr-3 text-primary-500"></i> إضافة محتوى جديد
            </h2>
            <p class="text-dark-500 mt-1">اختر المحاضرة وأضف المحتوى التعليمي المناسب</p>
          </div>
          <div class="bg-secondary-100 text-secondary-800 px-3 py-1 rounded-full text-sm font-bold">
            <i class="fas fa-magic mr-1"></i> متعدد
          </div>
        </div>

        <form id="contentForm" class="space-y-8">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
              <label class="block text-sm font-bold text-dark-700 mb-2">الصف الدراسي <span class="text-red-500">*</span></label>
              <select id="contentStage" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500">
                <option value="" disabled selected>اختر الصف الدراسي</option>
                <option value="الصف الأول">الصف الأول</option>
                <option value="الصف الثاني">الصف الثاني</option>
                <option value="الصف الثالث">الصف الثالث</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-bold text-dark-700 mb-2">الكورس التعليمي <span class="text-red-500">*</span></label>
              <select id="contentCourse" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" disabled>
                <option value="" disabled selected>اختر الكورس</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-bold text-dark-700 mb-2">المحاضرة <span class="text-red-500">*</span></label>
              <select id="contentLecture" class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" disabled>
                <option value="" disabled selected>اختر المحاضرة</option>
              </select>
            </div>
          </div>

          <div>
            <label class="block text-sm font-bold text-dark-700 mb-2">عنوان المحتوى <span class="text-red-500">*</span></label>
            <input type="text" id="contentTitle" placeholder="أدخل عنوان المحتوى" required 
                   class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" />
          </div>

          <div>
            <label class="block text-sm font-bold text-dark-700 mb-4">نوع المحتوى <span class="text-red-500">*</span></label>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <label class="content-type-card flex items-center space-x-3 space-x-reverse p-4 border-2 border-gray-100 rounded-xl cursor-pointer transition-all duration-300 hover:border-primary-200">
                <input type="radio" name="contentType" value="video" checked class="h-5 w-5 text-primary-600 focus:ring-primary-500">
                <div class="flex-1">
                  <span class="block font-bold text-dark-800">فيديو تعليمي</span>
                  <span class="block text-xs text-dark-500 mt-1">رفع رابط فيديو من اليوتيوب أو غيره</span>
                </div>
                <div class="bg-primary-100 p-3 rounded-lg text-primary-600">
                  <i class="fas fa-video text-xl"></i>
                </div>
              </label>
              
              <label class="content-type-card flex items-center space-x-3 space-x-reverse p-4 border-2 border-gray-100 rounded-xl cursor-pointer transition-all duration-300 hover:border-primary-200">
                <input type="radio" name="contentType" value="pdf" class="h-5 w-5 text-primary-600 focus:ring-primary-500">
                <div class="flex-1">
                  <span class="block font-bold text-dark-800">ملف PDF</span>
                  <span class="block text-xs text-dark-500 mt-1">رفع ملف PDF أو مستند نصي</span>
                </div>
                <div class="bg-red-100 p-3 rounded-lg text-red-600">
                  <i class="fas fa-file-pdf text-xl"></i>
                </div>
              </label>
              
              <label class="content-type-card flex items-center space-x-3 space-x-reverse p-4 border-2 border-gray-100 rounded-xl cursor-pointer transition-all duration-300 hover:border-primary-200">
                <input type="radio" name="contentType" value="quiz" class="h-5 w-5 text-primary-600 focus:ring-primary-500">
                <div class="flex-1">
                  <span class="block font-bold text-dark-800">اختبار تفاعلي</span>
                  <span class="block text-xs text-dark-500 mt-1">إضافة اختبار أو واجب دراسي</span>
                </div>
                <div class="bg-purple-100 p-3 rounded-lg text-purple-600">
                  <i class="fas fa-question-circle text-xl"></i>
                </div>
              </label>
            </div>
          </div>

          <!-- Video Field -->
          <div id="videoField">
            <label class="block text-sm font-bold text-dark-700 mb-2">رابط الفيديو <span class="text-red-500">*</span></label>
            <div class="relative">
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-gray-400">
                <i class="fas fa-link"></i>
              </div>
              <input type="url" id="videoUrl" placeholder="https://www.youtube.com/watch?v=..." 
                     class="w-full input-field pr-10 pl-4 py-3 rounded-xl focus:ring-primary-500" />
            </div>
            <p class="text-xs text-dark-400 mt-1">يمكنك استخدام روابط اليوتيوب أو Vimeo أو أي خدمة فيديو أخرى</p>
          </div>

          <!-- PDF Field -->
          <div id="pdfField" class="hidden">
            <label class="block text-sm font-bold text-dark-700 mb-2">ملف PDF <span class="text-red-500">*</span></label>
            <div class="flex items-center justify-center w-full">
              <label for="pdfFile" class="flex flex-col items-center justify-center w-full h-40 border-2 border-dashed rounded-xl cursor-pointer bg-gray-50 hover:bg-gray-100 transition border-gray-300 hover:border-primary-300">
                <div class="flex flex-col items-center justify-center pt-5 pb-6 px-4 text-center" id="pdfUploadText">
                  <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                  <p class="mb-2 text-sm text-dark-500"><span class="font-bold">انقر لرفع الملف</span> أو اسحبه هنا</p>
                  <p class="text-xs text-gray-400">PDF, DOCX, PPTX (حتى 20MB)</p>
                </div>
                <input id="pdfFile" type="file" accept=".pdf,.doc,.docx,.ppt,.pptx" class="hidden" />
              </label>
            </div>
            
            <!-- Progress Bar -->
            <div id="pdfProgress" class="hidden mt-4">
              <div class="flex justify-between text-sm text-dark-500 mb-2">
                <span id="fileName" class="font-medium truncate max-w-xs">جاري تحميل الملف...</span>
                <span id="progressPercent" class="font-bold">0%</span>
              </div>
              <div class="w-full bg-gray-200 rounded-full h-2">
                <div id="progressBar" class="progress-bar h-2 rounded-full" style="width: 0%"></div>
              </div>
            </div>
            
            <!-- File Info -->
            <div id="fileInfo" class="hidden mt-4 p-4 bg-green-50 rounded-xl border border-green-200">
              <div class="flex items-center">
                <div class="bg-green-100 p-2 rounded-lg text-green-600 mr-3">
                  <i class="fas fa-check-circle"></i>
                </div>
                <div class="flex-1">
                  <h4 class="text-sm font-bold text-green-800">تم تحميل الملف بنجاح</h4>
                  <p class="text-xs text-green-700 mt-1" id="fileDetails"></p>
                </div>
                <button id="removeFile" class="text-red-500 hover:text-red-700 p-2">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
            </div>
          </div>

          <!-- Quiz Field -->
          <div id="quizField" class="hidden">
            <label class="block text-sm font-bold text-dark-700 mb-2">معرف الاختبار <span class="text-red-500">*</span></label>
            <div class="relative">
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-gray-400">
                <i class="fas fa-id-card"></i>
              </div>
              <input type="text" id="quizId" placeholder="أدخل معرف الاختبار أو رابط النموذج" 
                     class="w-full input-field pr-10 pl-4 py-3 rounded-xl focus:ring-primary-500" />
            </div>
            <p class="text-xs text-dark-400 mt-1">يمكنك استخدام Google Forms أو أي منصة اختبارات أخرى</p>
          </div>

          <div class="pt-4">
            <button type="submit" id="submitContentBtn" 
                    class="btn-primary w-full text-white py-4 px-6 rounded-xl hover:shadow-lg transition-all duration-300 flex items-center justify-center">
              <i class="fas fa-save mr-3"></i> حفظ المحتوى التعليمي
            </button>
          </div>
        </form>

        <!-- Success Message -->
        <div id="contentSuccessMsg" class="hidden p-6 bg-green-50 rounded-xl border-l-4 border-green-500">
          <div class="flex items-start">
            <div class="flex-shrink-0">
              <i class="fas fa-check-circle text-2xl text-green-500 mt-1"></i>
            </div>
            <div class="mr-3 flex-1">
              <h3 class="font-bold text-green-800">تم بنجاح!</h3>
              <p class="mt-1 text-sm text-green-700">تم إضافة المحتوى التعليمي بنجاح إلى النظام</p>
            </div>
            <button id="closeContentSuccess" class="text-green-500 hover:text-green-700">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Lecture Content Modal -->
    <div id="contentModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden backdrop-blur-sm transition-opacity duration-300">
      <div class="glass-card w-full max-w-4xl max-h-[90vh] overflow-y-auto transform transition-all duration-300 scale-95 opacity-0" id="modalContent">
        <div class="p-6 space-y-6">
          <div class="flex items-center justify-between border-b border-gray-200 pb-4">
            <h2 class="text-xl md:text-2xl font-black text-dark-800" id="modalLectureTitle"></h2>
            <button id="closeModal" class="text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100">
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          
          <div class="space-y-4">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
              <div class="grid grid-cols-2 gap-4">
                <div class="bg-primary-50 p-3 rounded-lg">
                  <p class="text-xs text-primary-600 font-bold">الصف الدراسي</p>
                  <p class="text-sm text-dark-800 font-medium mt-1" id="modalLectureStage"></p>
                </div>
                <div class="bg-secondary-50 p-3 rounded-lg">
                  <p class="text-xs text-secondary-600 font-bold">الكورس التعليمي</p>
                  <p class="text-sm text-dark-800 font-medium mt-1" id="modalLectureCourse"></p>
                </div>
              </div>
              <div class="flex space-x-2 space-x-reverse justify-end">
                <button id="editLectureBtn" class="px-4 py-2 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition flex items-center">
                  <i class="fas fa-edit mr-2"></i> تعديل
                </button>
                <button id="deleteLectureBtn" class="px-4 py-2 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition flex items-center">
                  <i class="fas fa-trash-alt mr-2"></i> حذف
                </button>
              </div>
            </div>
            
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-sm font-bold text-dark-700 mb-2">وصف المحاضرة</h3>
              <p class="text-gray-700" id="modalLectureDescription"></p>
            </div>
          </div>
          
          <div>
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold text-lg text-dark-800">محتويات المحاضرة</h3>
              <span class="bg-gray-100 px-3 py-1 rounded-full text-sm font-bold text-dark-600" id="contentsCount">0 محتوى</span>
            </div>
            <div id="lectureContents" class="space-y-4">
              <!-- سيتم ملؤها بالبيانات -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Lecture Modal -->
    <div id="editLectureModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden backdrop-blur-sm">
      <div class="glass-card w-full max-w-md transform transition-all duration-300 scale-95 opacity-0" id="editModalContent">
        <div class="p-6 space-y-6">
          <div class="flex items-center justify-between border-b border-gray-200 pb-4">
            <h2 class="text-xl font-bold text-dark-800">تعديل المحاضرة</h2>
            <button id="closeEditModal" class="text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100">
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          
          <form id="editLectureForm">
            <input type="hidden" id="editLectureId">
            <div class="space-y-6">
              <div>
                <label class="block text-sm font-bold text-dark-700 mb-2">عنوان المحاضرة <span class="text-red-500">*</span></label>
                <input type="text" id="editLectureTitle" required 
                       class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" />
              </div>
              
              <div>
                <label class="block text-sm font-bold text-dark-700 mb-2">وصف المحاضرة</label>
                <textarea id="editLectureDescription" rows="4"
                       class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500"></textarea>
              </div>
              
              <button type="submit" class="btn-primary w-full text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-300">
                <i class="fas fa-save mr-2"></i> حفظ التعديلات
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Edit Content Modal -->
    <div id="editContentModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden backdrop-blur-sm">
      <div class="glass-card w-full max-w-md transform transition-all duration-300 scale-95 opacity-0" id="editContentModalContent">
        <div class="p-6 space-y-6">
          <div class="flex items-center justify-between border-b border-gray-200 pb-4">
            <h2 class="text-xl font-bold text-dark-800">تعديل المحتوى</h2>
            <button id="closeEditContentModal" class="text-gray-500 hover:text-gray-700 p-1 rounded-full hover:bg-gray-100">
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          
          <form id="editContentForm">
            <input type="hidden" id="editContentId">
            <div class="space-y-6">
              <div>
                <label class="block text-sm font-bold text-dark-700 mb-2">عنوان المحتوى <span class="text-red-500">*</span></label>
                <input type="text" id="editContentTitle" required 
                       class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" />
              </div>
              
              <div id="editContentUrlField">
                <label class="block text-sm font-bold text-dark-700 mb-2" id="editContentUrlLabel">رابط المحتوى <span class="text-red-500">*</span></label>
                <input type="text" id="editContentUrl" 
                       class="w-full input-field px-4 py-3 rounded-xl focus:ring-primary-500" />
              </div>
              
              <div class="grid grid-cols-2 gap-4 pt-2">
                <button type="submit" class="btn-primary text-white py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-300">
                  <i class="fas fa-save mr-2"></i> حفظ
                </button>
                
                <button type="button" id="deleteContentBtn" class="w-full bg-red-50 text-red-700 py-3 px-6 rounded-xl hover:bg-red-100 transition flex items-center justify-center">
                  <i class="fas fa-trash-alt mr-2"></i> حذف
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden backdrop-blur-sm">
      <div class="glass-card w-full max-w-md transform transition-all duration-300 scale-95 opacity-0" id="confirmModalContent">
        <div class="p-6 space-y-6">
          <div class="flex items-center justify-center text-red-500 mb-4">
            <i class="fas fa-exclamation-triangle text-4xl"></i>
          </div>
          <h2 class="text-xl font-bold text-center text-dark-800" id="confirmModalTitle">تأكيد الحذف</h2>
          <p class="text-center text-dark-600" id="confirmModalMessage">هل أنت متأكد من أنك تريد حذف هذا العنصر؟ لا يمكن التراجع عن هذا الإجراء.</p>
          
          <div class="grid grid-cols-2 gap-4 pt-4">
            <button id="confirmCancel" class="w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-xl hover:bg-gray-200 transition">
              إلغاء
            </button>
            <button id="confirmAction" class="w-full bg-red-600 text-white py-3 px-6 rounded-xl hover:bg-red-700 transition">
              تأكيد الحذف
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="text-center mt-12 pt-6 border-t border-gray-200">
      <div class="flex items-center justify-center space-x-4 space-x-reverse mb-3">
        <a href="#" class="text-gray-500 hover:text-primary-600 transition">
          <i class="fab fa-twitter text-lg"></i>
        </a>
        <a href="#" class="text-gray-500 hover:text-primary-600 transition">
          <i class="fab fa-facebook text-lg"></i>
        </a>
        <a href="#" class="text-gray-500 hover:text-primary-600 transition">
          <i class="fab fa-instagram text-lg"></i>
        </a>
        <a href="#" class="text-gray-500 hover:text-primary-600 transition">
          <i class="fab fa-linkedin text-lg"></i>
        </a>
      </div>
      <p class="text-sm text-gray-500">نظام إدارة المحتوى التعليمي &copy; <span id="currentYear"></span> - جميع الحقوق محفوظة</p>
    </div>
  </div>

  <script>
    // Firebase Init
    firebase.initializeApp({
      apiKey: "AIzaSyBoPJbx5v6EkOqxOJkbhzHqIJdAByh79Rg",
      authDomain: "hhhhhh-d4fb8.firebaseapp.com",
      projectId: "hhhhhh-d4fb8",
      storageBucket: "hhhhhh-d4fb8.appspot.com"
    });

    const db = firebase.firestore();
    const storage = firebase.storage();

    // عناصر الواجهة
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    
    // عناصر قسم المحاضرات
    const filterStage = document.getElementById('filterStage');
    const filterCourse = document.getElementById('filterCourse');
    const filterDate = document.getElementById('filterDate');
    const filterBtn = document.getElementById('filterBtn');
    const refreshLectures = document.getElementById('refreshLectures');
    const lecturesTableBody = document.getElementById('lecturesTableBody');
    const lecturesLoading = document.getElementById('lecturesLoading');
    const lecturesEmpty = document.getElementById('lecturesEmpty');
    const lecturesCount = document.getElementById('lecturesCount');
    const lecturesCountNumber = document.getElementById('lecturesCountNumber');
    
    // عناصر إضافة محاضرة
    const lectureForm = document.getElementById('lectureForm');
    const lectureStage = document.getElementById('lectureStage');
    const lectureCourse = document.getElementById('lectureCourse');
    const lectureTitle = document.getElementById('lectureTitle');
    const lectureDescription = document.getElementById('lectureDescription');
    const saveLectureBtn = document.getElementById('saveLectureBtn');
    const lectureSuccessMsg = document.getElementById('lectureSuccessMsg');
    const lectureSuccessText = document.getElementById('lectureSuccessText');
    const closeLectureSuccess = document.getElementById('closeLectureSuccess');
    
    // عناصر إضافة محتوى
    const contentForm = document.getElementById('contentForm');
    const contentStage = document.getElementById('contentStage');
    const contentCourse = document.getElementById('contentCourse');
    const contentLecture = document.getElementById('contentLecture');
    const contentTitle = document.getElementById('contentTitle');
    const videoField = document.getElementById('videoField');
    const pdfField = document.getElementById('pdfField');
    const quizField = document.getElementById('quizField');
    const videoUrl = document.getElementById('videoUrl');
    const pdfInput = document.getElementById('pdfFile');
    const quizInput = document.getElementById('quizId');
    const submitContentBtn = document.getElementById('submitContentBtn');
    const contentSuccessMsg = document.getElementById('contentSuccessMsg');
    const closeContentSuccess = document.getElementById('closeContentSuccess');
    const pdfUploadText = document.getElementById('pdfUploadText');
    const pdfProgress = document.getElementById('pdfProgress');
    const fileInfo = document.getElementById('fileInfo');
    const fileDetails = document.getElementById('fileDetails');
    const progressBar = document.getElementById('progressBar');
    const progressPercent = document.getElementById('progressPercent');
    const fileName = document.getElementById('fileName');
    const removeFile = document.getElementById('removeFile');
    
    // عناصر المودال
    const contentModal = document.getElementById('contentModal');
    const modalContent = document.getElementById('modalContent');
    const modalLectureTitle = document.getElementById('modalLectureTitle');
    const modalLectureStage = document.getElementById('modalLectureStage');
    const modalLectureCourse = document.getElementById('modalLectureCourse');
    const modalLectureDescription = document.getElementById('modalLectureDescription');
    const lectureContents = document.getElementById('lectureContents');
    const contentsCount = document.getElementById('contentsCount');
    const closeModal = document.getElementById('closeModal');
    const editLectureBtn = document.getElementById('editLectureBtn');
    const deleteLectureBtn = document.getElementById('deleteLectureBtn');
    
    // مودال تعديل المحاضرة
    const editLectureModal = document.getElementById('editLectureModal');
    const editModalContent = document.getElementById('editModalContent');
    const editLectureForm = document.getElementById('editLectureForm');
    const editLectureId = document.getElementById('editLectureId');
    const editLectureTitle = document.getElementById('editLectureTitle');
    const editLectureDescription = document.getElementById('editLectureDescription');
    const closeEditModal = document.getElementById('closeEditModal');
    
    // مودال تعديل المحتوى
    const editContentModal = document.getElementById('editContentModal');
    const editContentModalContent = document.getElementById('editContentModalContent');
    const editContentForm = document.getElementById('editContentForm');
    const editContentId = document.getElementById('editContentId');
    const editContentTitle = document.getElementById('editContentTitle');
    const editContentUrl = document.getElementById('editContentUrl');
    const editContentUrlField = document.getElementById('editContentUrlField');
    const editContentUrlLabel = document.getElementById('editContentUrlLabel');
    const closeEditContentModal = document.getElementById('closeEditContentModal');
    const deleteContentBtn = document.getElementById('deleteContentBtn');
    
    // مودال التأكيد
    const confirmModal = document.getElementById('confirmModal');
    const confirmModalContent = document.getElementById('confirmModalContent');
    const confirmModalTitle = document.getElementById('confirmModalTitle');
    const confirmModalMessage = document.getElementById('confirmModalMessage');
    const confirmCancel = document.getElementById('confirmCancel');
    const confirmAction = document.getElementById('confirmAction');
    
    // متغيرات التطبيق
    let uploadedFileUrl = '';
    let uploadedFileName = '';
    let currentLectureId = '';
    let courses = [];
    let currentContentType = 'video';
    let currentContentId = '';
    let currentYear = new Date().getFullYear();
    
    // تعيين سنة حقوق النشر
    document.getElementById('currentYear').textContent = currentYear;

    // تبديل التبويبات
    tabBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const tabId = btn.getAttribute('data-tab');
        
        tabBtns.forEach(b => {
          b.classList.remove('bg-white', 'shadow-md', 'text-primary-600');
          b.classList.add('text-dark-500', 'hover:text-primary-600');
        });
        
        btn.classList.remove('text-dark-500', 'hover:text-primary-600');
        btn.classList.add('bg-white', 'shadow-md', 'text-primary-600');
        
        tabContents.forEach(content => content.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
      });
    });

    // تحميل الكورسات عند اختيار الصف (إضافة محاضرة)
    lectureStage.addEventListener('change', async () => {
      const stage = lectureStage.value;
      lectureCourse.innerHTML = '<option disabled selected>جاري التحميل...</option>';
      lectureCourse.disabled = true;

      try {
        const snapshot = await db.collection("courses").where("stage", "==", stage).get();
        lectureCourse.innerHTML = '<option value="" disabled selected>اختر الكورس</option>';
        
        if (snapshot.empty) {
          lectureCourse.innerHTML = '<option disabled selected>لا توجد كورسات متاحة</option>';
        } else {
          snapshot.forEach(doc => {
            const c = doc.data();
            const option = document.createElement("option");
            option.value = c.id;
            option.textContent = c.name;
            lectureCourse.appendChild(option);
          });
        }

        lectureCourse.disabled = false;
      } catch (error) {
        console.error("Error loading courses:", error);
        lectureCourse.innerHTML = '<option disabled selected>خطأ في تحميل الكورسات</option>';
      }
    });

    // تحميل الكورسات عند اختيار الصف (تصفية المحاضرات)
    filterStage.addEventListener('change', async () => {
      const stage = filterStage.value;
      filterCourse.innerHTML = '<option value="">كل الكورسات</option>';
      filterCourse.disabled = !stage;

      if (stage) {
        try {
          const snapshot = await db.collection("courses").where("stage", "==", stage).get();
          
          if (!snapshot.empty) {
            snapshot.forEach(doc => {
              const c = doc.data();
              const option = document.createElement("option");
              option.value = c.id;
              option.textContent = c.name;
              filterCourse.appendChild(option);
            });
          }
        } catch (error) {
          console.error("Error loading courses:", error);
        }
      }
    });

    // تحميل الكورسات عند اختيار الصف (إضافة محتوى)
    contentStage.addEventListener('change', async () => {
      const stage = contentStage.value;
      contentCourse.innerHTML = '<option disabled selected>جاري التحميل...</option>';
      contentCourse.disabled = true;

      try {
        const snapshot = await db.collection("courses").where("stage", "==", stage).get();
        contentCourse.innerHTML = '<option value="" disabled selected>اختر الكورس</option>';
        
        if (snapshot.empty) {
          contentCourse.innerHTML = '<option disabled selected>لا توجد كورسات متاحة</option>';
        } else {
          snapshot.forEach(doc => {
            const c = doc.data();
            const option = document.createElement("option");
            option.value = c.id;
            option.textContent = c.name;
            contentCourse.appendChild(option);
          });
        }

        contentCourse.disabled = false;
        contentLecture.innerHTML = '<option disabled selected>اختر المحاضرة</option>';
        contentLecture.disabled = true;
      } catch (error) {
        console.error("Error loading courses:", error);
        contentCourse.innerHTML = '<option disabled selected>خطأ في تحميل الكورسات</option>';
      }
    });

    // تحميل المحاضرات عند اختيار الكورس (إضافة محتوى)
    contentCourse.addEventListener('change', async () => {
      const courseId = contentCourse.value;
      contentLecture.innerHTML = '<option disabled selected>جاري التحميل...</option>';
      contentLecture.disabled = true;

      try {
        const snapshot = await db.collection("lectures").where("courseId", "==", courseId).get();
        contentLecture.innerHTML = '<option value="" disabled selected>اختر المحاضرة</option>';
        
        if (snapshot.empty) {
          contentLecture.innerHTML = '<option disabled selected>لا توجد محاضرات متاحة</option>';
        } else {
          snapshot.forEach(doc => {
            const l = doc.data();
            const option = document.createElement("option");
            option.value = doc.id;
            option.textContent = l.lectureTitle;
            contentLecture.appendChild(option);
          });
        }

        contentLecture.disabled = false;
      } catch (error) {
        console.error("Error loading lectures:", error);
        contentLecture.innerHTML = '<option disabled selected>خطأ في تحميل المحاضرات</option>';
      }
    });

    // تغيير نوع المحتوى
    document.querySelectorAll('input[name="contentType"]').forEach(r => {
      r.addEventListener("change", () => {
        const type = r.value;
        currentContentType = type;
        videoField.classList.toggle("hidden", type !== "video");
        pdfField.classList.toggle("hidden", type !== "pdf");
        quizField.classList.toggle("hidden", type !== "quiz");
        
        // تحديث حالة بطاقة الاختيار
        document.querySelectorAll('.content-type-card').forEach(card => {
          card.classList.remove('selected', 'border-primary-300');
        });
        
        r.closest('.content-type-card').classList.add('selected', 'border-primary-300');
      });
    });

    // إدارة رفع ملف PDF
    pdfInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;

      // التحقق من نوع الملف
      const validTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'application/vnd.ms-powerpoint', 'application/vnd.openxmlformats-officedocument.presentationml.presentation'];
      if (!validTypes.includes(file.type)) {
        alert("الرجاء اختيار ملف PDF أو مستند Word أو PowerPoint فقط");
        return;
      }

      // التحقق من حجم الملف (20MB كحد أقصى)
      if (file.size > 20 * 1024 * 1024) {
        alert("حجم الملف كبير جداً. الحد الأقصى 20MB");
        return;
      }

      uploadedFileName = file.name;
      fileName.textContent = file.name;
      pdfUploadText.classList.add("hidden");
      pdfProgress.classList.remove("hidden");
      fileInfo.classList.add("hidden");

      // رفع الملف إلى Firebase Storage
      uploadFile(file);
    });

    // دالة رفع الملف مع متابعة التقدم
    function uploadFile(file) {
      submitContentBtn.disabled = true;
      
      const fileRef = storage.ref(`lecture-files/${Date.now()}_${file.name}`);
      const uploadTask = fileRef.put(file);

      uploadTask.on('state_changed',
        (snapshot) => {
          // تحديث شريط التقدم
          const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
          progressBar.style.width = `${progress}%`;
          progressPercent.textContent = `${Math.round(progress)}%`;
        },
        (error) => {
          console.error("Upload error:", error);
          alert("حدث خطأ أثناء رفع الملف: " + error.message);
          resetPdfUpload();
        },
        () => {
          // عند اكتمال الرفع
          uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
            uploadedFileUrl = downloadURL;
            progressBar.style.width = '100%';
            progressPercent.textContent = '100%';
            
            // عرض معلومات الملف
            pdfProgress.classList.add("hidden");
            fileInfo.classList.remove("hidden");
            fileDetails.innerHTML = `
              <span class="font-bold">${file.name}</span><br>
              <span>${(file.size / (1024 * 1024)).toFixed(2)} MB</span>
            `;
            
            submitContentBtn.disabled = false;
          });
        }
      );
    }

    // إزالة الملف المرفوع
    removeFile.addEventListener("click", (e) => {
      e.preventDefault();
      resetPdfUpload();
    });

    // إعادة تعيين حقل PDF
    function resetPdfUpload() {
      pdfInput.value = '';
      uploadedFileUrl = '';
      uploadedFileName = '';
      progressBar.style.width = '0%';
      progressPercent.textContent = '0%';
      pdfUploadText.classList.remove("hidden");
      pdfProgress.classList.add("hidden");
      fileInfo.classList.add("hidden");
      submitContentBtn.disabled = false;
    }

    // إغلاق رسالة النجاح (إضافة محتوى)
    closeContentSuccess.addEventListener("click", () => {
      contentSuccessMsg.classList.add("hidden");
    });

    // إغلاق رسالة النجاح (إضافة محاضرة)
    closeLectureSuccess.addEventListener("click", () => {
      lectureSuccessMsg.classList.add("hidden");
    });

    // حفظ محاضرة جديدة
    lectureForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      
      const stage = lectureStage.value;
      const courseId = lectureCourse.value;
      const title = lectureTitle.value.trim();
      const description = lectureDescription.value.trim();

      if (!stage || !courseId || !title) {
        showAlert('error', 'الحقول المطلوبة', 'الرجاء تعبئة جميع الحقول المطلوبة');
        return;
      }

      saveLectureBtn.disabled = true;
      saveLectureBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> جاري الحفظ...';

      try {
        // الحصول على اسم الكورس
        const courseDoc = await db.collection("courses").doc(courseId).get();
        const courseName = courseDoc.data().name;

        // حفظ المحاضرة في Firestore
        await db.collection("lectures").add({
          stage,
          courseId,
          courseName,
          lectureTitle: title,
          lectureDescription: description,
          createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        // إعادة تعيين النموذج
        lectureForm.reset();
        lectureCourse.innerHTML = '<option value="" disabled selected>اختر الكورس</option>';
        lectureCourse.disabled = true;
        
        // عرض رسالة النجاح
        lectureSuccessText.textContent = `تم إضافة محاضرة "${title}" بنجاح`;
        lectureSuccessMsg.classList.remove("hidden");
        
        // إعادة تعيين الزر
        setTimeout(() => {
          saveLectureBtn.disabled = false;
          saveLectureBtn.innerHTML = '<i class="fas fa-save mr-2"></i> حفظ المحاضرة';
        }, 2000);
        
        // إخفاء رسالة النجاح بعد 5 ثواني
        setTimeout(() => {
          lectureSuccessMsg.classList.add("hidden");
        }, 5000);
      } catch (err) {
        console.error(err);
        saveLectureBtn.disabled = false;
        saveLectureBtn.innerHTML = '<i class="fas fa-save mr-2"></i> حفظ المحاضرة';
        showAlert('error', 'خطأ في الحفظ', 'حدث خطأ أثناء حفظ المحاضرة: ' + err.message);
      }
    });

    // حفظ محتوى جديد
    contentForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      
      const lectureId = contentLecture.value;
      const title = contentTitle.value.trim();
      const type = document.querySelector('input[name="contentType"]:checked').value;

      if (!lectureId || !title) {
        showAlert('error', 'الحقول المطلوبة', 'الرجاء تعبئة جميع الحقول المطلوبة');
        return;
      }

      let url = '';
      submitContentBtn.disabled = true;
      submitContentBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> جاري الحفظ...';

      try {
        if (type === "video") {
          url = videoUrl.value.trim();
          if (!url) {
            showAlert('error', 'رابط الفيديو', 'الرجاء إدخال رابط الفيديو');
            throw new Error("No video URL");
          }
        } else if (type === "pdf") {
          if (!uploadedFileUrl) {
            showAlert('error', 'ملف مطلوب', 'الرجاء رفع ملف PDF أولاً');
            throw new Error("No PDF file");
          }
          url = uploadedFileUrl;
        } else if (type === "quiz") {
          url = quizInput.value.trim();
          if (!url) {
            showAlert('error', 'معرف الاختبار', 'الرجاء إدخال معرف الاختبار');
            throw new Error("No quiz ID");
          }
        }

        // حفظ البيانات في Firestore
        await db.collection("lectureContent").add({
          lectureId,
          title,
          type,
          url,
          fileName: type === 'pdf' ? uploadedFileName : null,
          createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        // إعادة تعيين النموذج
        contentTitle.value = '';
        videoUrl.value = '';
        quizInput.value = '';
        resetPdfUpload();
        
        // عرض رسالة النجاح
        contentSuccessMsg.classList.remove("hidden");
        
        // إعادة تعيين الزر
        setTimeout(() => {
          submitContentBtn.disabled = false;
          submitContentBtn.innerHTML = '<i class="fas fa-save mr-2"></i> حفظ المحتوى';
        }, 2000);
        
        // إخفاء رسالة النجاح بعد 5 ثواني
        setTimeout(() => {
          contentSuccessMsg.classList.add("hidden");
        }, 5000);
      } catch (err) {
        console.error(err);
        submitContentBtn.disabled = false;
        submitContentBtn.innerHTML = '<i class="fas fa-save mr-2"></i> حفظ المحتوى';
        showAlert('error', 'خطأ في الحفظ', 'حدث خطأ أثناء حفظ المحتوى: ' + err.message);
      }
    });

    // تصفية وعرض المحاضرات
    filterBtn.addEventListener('click', loadLectures);
    refreshLectures.addEventListener('click', loadLectures);

    // تحميل المحاضرات
    async function loadLectures() {
      lecturesTableBody.innerHTML = '';
      lecturesLoading.classList.remove('hidden');
      lecturesEmpty.classList.add('hidden');
      
      let query = db.collection("lectures").orderBy("createdAt", "desc");
      
      const stage = filterStage.value;
      const courseId = filterCourse.value;
      const dateFilter = filterDate.value;
      
      if (stage) query = query.where("stage", "==", stage);
      if (courseId) query = query.where("courseId", "==", courseId);
      
      // تطبيق تصفية التاريخ إذا تم اختياره
      if (dateFilter) {
        const now = new Date();
        let startDate;
        
        if (dateFilter === 'day') {
          startDate = new Date(now.getTime() - 24 * 60 * 60 * 1000);
        } else if (dateFilter === 'week') {
          startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
        } else if (dateFilter === 'month') {
          startDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
        }
        
        query = query.where("createdAt", ">=", startDate);
      }
      
      try {
        const snapshot = await query.get();
        lecturesTableBody.innerHTML = '';
        
        if (snapshot.empty) {
          lecturesLoading.classList.add('hidden');
          lecturesEmpty.classList.remove('hidden');
        } else {
          // حساب عدد المحتويات لكل محاضرة
          const contentsCount = {};
          const contentsSnapshot = await db.collection("lectureContent").get();
          contentsSnapshot.forEach(doc => {
            const data = doc.data();
            contentsCount[data.lectureId] = (contentsCount[data.lectureId] || 0) + 1;
          });
          
          snapshot.forEach(doc => {
            const l = doc.data();
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50 transition';
            row.innerHTML = `
              <td class="p-4 border-b">
                <div class="font-bold text-dark-800">${l.lectureTitle}</div>
                ${l.lectureDescription ? `<div class="text-xs text-dark-500 mt-1 truncate max-w-xs">${l.lectureDescription}</div>` : ''}
              </td>
              <td class="p-4 border-b text-dark-700">${l.stage}</td>
              <td class="p-4 border-b text-dark-700">${l.courseName}</td>
              <td class="p-4 border-b text-center">
                <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-primary-100 text-primary-800 font-bold">
                  ${contentsCount[doc.id] || 0}
                </span>
              </td>
              <td class="p-4 border-b text-center">
                <button class="view-lecture px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition flex items-center mx-auto" 
                        data-id="${doc.id}" data-stage="${l.stage}" data-course="${l.courseName}" 
                        data-title="${l.lectureTitle}" data-desc="${l.lectureDescription || 'لا يوجد وصف'}">
                  <i class="fas fa-eye mr-2"></i> عرض
                </button>
              </td>
            `;
            lecturesTableBody.appendChild(row);
          });
          
          // إضافة مستمعين لأزرار العرض
          document.querySelectorAll('.view-lecture').forEach(btn => {
            btn.addEventListener('click', () => {
              const lectureId = btn.getAttribute('data-id');
              const stage = btn.getAttribute('data-stage');
              const course = btn.getAttribute('data-course');
              const title = btn.getAttribute('data-title');
              const desc = btn.getAttribute('data-desc');
              
              showLectureModal(lectureId, stage, course, title, desc);
            });
          });
          
          lecturesCount.textContent = `${snapshot.size} محاضرة`;
          lecturesCountNumber.textContent = snapshot.size;
          lecturesLoading.classList.add('hidden');
        }
      } catch (error) {
        console.error("Error loading lectures:", error);
        lecturesTableBody.innerHTML = `
          <tr>
            <td colspan="5" class="p-4 text-center text-red-500">
              <div class="flex items-center justify-center space-x-2">
                <i class="fas fa-exclamation-circle"></i>
                <span>حدث خطأ أثناء تحميل المحاضرات</span>
              </div>
            </td>
          </tr>
        `;
        lecturesLoading.classList.add('hidden');
      }
    }

    // عرض مودال المحاضرة مع محتوياتها
    async function showLectureModal(lectureId, stage, course, title, desc) {
      currentLectureId = lectureId;
      modalLectureTitle.textContent = title;
      modalLectureStage.textContent = stage;
      modalLectureCourse.textContent = course;
      modalLectureDescription.textContent = desc || 'لا يوجد وصف متاح';
      
      // تحميل محتويات المحاضرة
      lectureContents.innerHTML = `
        <div class="text-center py-8">
          <div class="loader mx-auto"></div>
          <p class="mt-4 text-dark-600 font-medium">جاري تحميل المحتويات...</p>
        </div>
      `;
      
      // عرض المودال مع تأثير
      contentModal.classList.remove('hidden');
      setTimeout(() => {
        modalContent.classList.remove('scale-95', 'opacity-0');
        modalContent.classList.add('scale-100', 'opacity-100');
      }, 10);
      
      try {
        const snapshot = await db.collection("lectureContent")
                               .where("lectureId", "==", lectureId)
                               .orderBy("createdAt", "desc")
                               .get();
        
        lectureContents.innerHTML = '';
        
        if (snapshot.empty) {
          lectureContents.innerHTML = `
            <div class="text-center py-8">
              <div class="mx-auto bg-gray-100 w-16 h-16 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-folder-open text-2xl text-gray-500"></i>
              </div>
              <h3 class="text-lg font-bold text-dark-800 mb-2">لا يوجد محتوى</h3>
              <p class="text-dark-500">لا يوجد محتوى لهذه المحاضرة بعد</p>
            </div>
          `;
          contentsCount.textContent = '0 محتوى';
        } else {
          let contentsHtml = '';
          snapshot.forEach(doc => {
            const content = doc.data();
            
            let icon, typeText, bgColor, textColor;
            if (content.type === 'video') {
              icon = 'fa-video';
              typeText = 'فيديو';
              bgColor = 'bg-indigo-100';
              textColor = 'text-indigo-600';
            } else if (content.type === 'pdf') {
              icon = 'fa-file-pdf';
              typeText = 'ملف';
              bgColor = 'bg-red-100';
              textColor = 'text-red-600';
            } else {
              icon = 'fa-question-circle';
              typeText = 'اختبار';
              bgColor = 'bg-purple-100';
              textColor = 'text-purple-600';
            }
            
            contentsHtml += `
              <div class="p-4 border rounded-xl bg-white shadow-sm hover:shadow-md transition">
                <div class="flex items-start justify-between">
                  <div class="flex items-start space-x-3 space-x-reverse">
                    <div class="${bgColor} p-2 rounded-lg ${textColor} mt-1">
                      <i class="fas ${icon} text-lg"></i>
                    </div>
                    <div>
                      <h4 class="font-bold text-dark-800">${content.title}</h4>
                      <div class="flex items-center space-x-2 space-x-reverse mt-1">
                        <span class="text-xs px-2 py-1 bg-gray-100 rounded-full">${typeText}</span>
                        <span class="text-xs text-dark-500">${formatDate(content.createdAt?.toDate())}</span>
                      </div>
                    </div>
                  </div>
                  <div class="flex space-x-2 space-x-reverse">
                    <button class="edit-content p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition" 
                            data-id="${doc.id}" data-title="${content.title}" data-type="${content.type}" data-url="${content.url}">
                      <i class="fas fa-edit"></i>
                    </button>
                    <button class="delete-content p-2 text-red-600 hover:bg-red-50 rounded-lg transition" 
                            data-id="${doc.id}" data-type="${content.type}" data-url="${content.url}">
                      <i class="fas fa-trash-alt"></i>
                    </button>
                  </div>
                </div>
              </div>
            `;
          });
          
          lectureContents.innerHTML = contentsHtml;
          contentsCount.textContent = `${snapshot.size} محتوى`;
          
          // إضافة مستمعين لأزرار التعديل والحذف
          document.querySelectorAll('.edit-content').forEach(btn => {
            btn.addEventListener('click', (e) => {
              e.stopPropagation();
              const contentId = btn.getAttribute('data-id');
              const title = btn.getAttribute('data-title');
              const type = btn.getAttribute('data-type');
              const url = btn.getAttribute('data-url');
              
              editContent(contentId, title, type, url);
            });
          });
          
          document.querySelectorAll('.delete-content').forEach(btn => {
            btn.addEventListener('click', (e) => {
              e.stopPropagation();
              const contentId = btn.getAttribute('data-id');
              const type = btn.getAttribute('data-type');
              const url = btn.getAttribute('data-url');
              
              showConfirmModal(
                'حذف المحتوى',
                'هل أنت متأكد من حذف هذا المحتوى؟ لا يمكن التراجع عن هذا الإجراء.',
                () => deleteContent(contentId, type, url)
              );
            });
          });
        }
      } catch (error) {
        console.error("Error loading lecture contents:", error);
        lectureContents.innerHTML = `
          <div class="text-center py-8">
            <div class="mx-auto bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mb-4">
              <i class="fas fa-exclamation-circle text-2xl text-red-500"></i>
            </div>
            <h3 class="text-lg font-bold text-dark-800 mb-2">حدث خطأ</h3>
            <p class="text-dark-500">تعذر تحميل محتويات المحاضرة</p>
          </div>
        `;
      }
    }

    // تنسيق التاريخ
    function formatDate(date) {
      if (!date) return 'غير معروف';
      
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      return new Intl.DateTimeFormat('ar-EG', options).format(date);
    }

    // إغلاق مودال المحاضرة
    closeModal.addEventListener('click', () => {
      modalContent.classList.add('scale-95', 'opacity-0');
      setTimeout(() => {
        contentModal.classList.add('hidden');
        currentLectureId = '';
      }, 300);
    });

    // فتح مودال تعديل المحاضرة
    editLectureBtn.addEventListener('click', () => {
      editLectureId.value = currentLectureId;
      editLectureTitle.value = modalLectureTitle.textContent;
      editLectureDescription.value = modalLectureDescription.textContent;
      
      // إغلاق المودال الحالي
      modalContent.classList.add('scale-95', 'opacity-0');
      setTimeout(() => {
        contentModal.classList.add('hidden');
        
        // فتح مودال التعديل
        editLectureModal.classList.remove('hidden');
        setTimeout(() => {
          editModalContent.classList.remove('scale-95', 'opacity-0');
          editModalContent.classList.add('scale-100', 'opacity-100');
        }, 10);
      }, 300);
    });

    // إغلاق مودال تعديل المحاضرة
    closeEditModal.addEventListener('click', () => {
      editModalContent.classList.add('scale-95', 'opacity-0');
      setTimeout(() => {
        editLectureModal.classList.add('hidden');
        
        // إعادة فتح مودال المحاضرة
        showLectureModal(currentLectureId, 
                         modalLectureStage.textContent, 
                         modalLectureCourse.textContent, 
                         modalLectureTitle.textContent, 
                         modalLectureDescription.textContent);
      }, 300);
    });

    // حفظ تعديلات المحاضرة
    editLectureForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const id = editLectureId.value;
      const title = editLectureTitle.value.trim();
      const description = editLectureDescription.value.trim();
      
      if (!title) {
        showAlert('error', 'العنوان مطلوب', 'الرجاء إدخال عنوان المحاضرة');
        return;
      }
      
      try {
        await db.collection("lectures").doc(id).update({
          lectureTitle: title,
          lectureDescription: description,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // إغلاق مودال التعديل
        editModalContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => {
          editLectureModal.classList.add('hidden');
          
          // إعادة فتح مودال المحاضرة مع البيانات المحدثة
          showLectureModal(id, 
                           modalLectureStage.textContent, 
                           modalLectureCourse.textContent, 
                           title, 
                           description);
        }, 300);
        
        // تحديث الجدول الرئيسي
        loadLectures();
      } catch (error) {
        console.error("Error updating lecture:", error);
        showAlert('error', 'خطأ في التحديث', 'حدث خطأ أثناء تحديث المحاضرة');
      }
    });

    // حذف المحاضرة
    deleteLectureBtn.addEventListener('click', async () => {
      showConfirmModal(
        'حذف المحاضرة',
        'هل أنت متأكد من حذف هذه المحاضرة وجميع محتوياتها؟ لا يمكن التراجع عن هذا الإجراء.',
        async () => {
          try {
            // حذف المحاضرة
            await db.collection("lectures").doc(currentLectureId).delete();
            
            // حذف جميع محتويات المحاضرة
            const snapshot = await db.collection("lectureContent")
                                   .where("lectureId", "==", currentLectureId)
                                   .get();
            
            const batch = db.batch();
            snapshot.forEach(doc => {
              const content = doc.data();
              // حذف ملف PDF من التخزين إذا كان نوع المحتوى PDF
              if (content.type === 'pdf' && content.url) {
                const fileRef = storage.refFromURL(content.url);
                fileRef.delete().catch(err => console.error("Error deleting file:", err));
              }
              batch.delete(doc.ref);
            });
            await batch.commit();
            
            // إغلاق المودال وتحديث الجدول
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
              contentModal.classList.add('hidden');
              loadLectures();
            }, 300);
            
            showAlert('success', 'تم الحذف', 'تم حذف المحاضرة ومحتوياتها بنجاح');
          } catch (error) {
            console.error("Error deleting lecture:", error);
            showAlert('error', 'خطأ في الحذف', 'حدث خطأ أثناء حذف المحاضرة');
          }
        }
      );
    });

    // تعديل محتوى
    function editContent(contentId, title, type, url) {
      currentContentId = contentId;
      editContentId.value = contentId;
      editContentTitle.value = title;
      
      // إظهار الحقل المناسب لنوع المحتوى
      if (type === 'video') {
        editContentUrlLabel.textContent = 'رابط الفيديو';
        editContentUrl.value = url;
      } else if (type === 'pdf') {
        editContentUrlLabel.textContent = 'رابط الملف';
        editContentUrl.value = url;
      } else {
        editContentUrlLabel.textContent = 'معرف الاختبار';
        editContentUrl.value = url;
      }
      
      // إغلاق المودال الحالي
      modalContent.classList.add('scale-95', 'opacity-0');
      setTimeout(() => {
        contentModal.classList.add('hidden');
        
        // فتح مودال تعديل المحتوى
        editContentModal.classList.remove('hidden');
        setTimeout(() => {
          editContentModalContent.classList.remove('scale-95', 'opacity-0');
          editContentModalContent.classList.add('scale-100', 'opacity-100');
        }, 10);
      }, 300);
    }

    // إغلاق مودال تعديل المحتوى
    closeEditContentModal.addEventListener('click', () => {
      editContentModalContent.classList.add('scale-95', 'opacity-0');
      setTimeout(() => {
        editContentModal.classList.add('hidden');
        
        // إعادة فتح مودال المحاضرة
        showLectureModal(currentLectureId, 
                         modalLectureStage.textContent, 
                         modalLectureCourse.textContent, 
                         modalLectureTitle.textContent, 
                         modalLectureDescription.textContent);
      }, 300);
    });

    // حفظ تعديلات المحتوى
    editContentForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const id = editContentId.value;
      const title = editContentTitle.value.trim();
      const url = editContentUrl.value.trim();
      
      if (!title || !url) {
        showAlert('error', 'الحقول المطلوبة', 'الرجاء تعبئة جميع الحقول المطلوبة');
        return;
      }
      
      try {
        await db.collection("lectureContent").doc(id).update({
          title,
          url,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // إغلاق مودال التعديل
        editContentModalContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => {
          editContentModal.classList.add('hidden');
          
          // إعادة فتح مودال المحاضرة مع البيانات المحدثة
          showLectureModal(currentLectureId, 
                           modalLectureStage.textContent, 
                           modalLectureCourse.textContent, 
                           modalLectureTitle.textContent, 
                           modalLectureDescription.textContent);
        }, 300);
      } catch (error) {
        console.error("Error updating content:", error);
        showAlert('error', 'خطأ في التحديث', 'حدث خطأ أثناء تحديث المحتوى');
      }
    });

    // حذف محتوى
    async function deleteContent(contentId, type, url) {
      try {
        // حذف ملف PDF من التخزين إذا كان نوع المحتوى PDF
        if (type === 'pdf' && url) {
          const fileRef = storage.refFromURL(url);
          await fileRef.delete();
        }
        
        // حذف المحتوى من Firestore
        await db.collection("lectureContent").doc(contentId).delete();
        
        // إعادة تحميل محتويات المحاضرة
        showLectureModal(currentLectureId, 
                         modalLectureStage.textContent, 
                         modalLectureCourse.textContent, 
                         modalLectureTitle.textContent, 
                         modalLectureDescription.textContent);
        
        showAlert('success', 'تم الحذف', 'تم حذف المحتوى بنجاح');
      } catch (error) {
        console.error("Error deleting content:", error);
        showAlert('error', 'خطأ في الحذف', 'حدث خطأ أثناء حذف المحتوى');
      }
    }

    // حذف المحتوى من زر الحذف في المودال
    deleteContentBtn.addEventListener('click', async () => {
      showConfirmModal(
        'حذف المحتوى',
        'هل أنت متأكد من حذف هذا المحتوى؟ لا يمكن التراجع عن هذا الإجراء.',
        async () => {
          try {
            // الحصول على بيانات المحتوى أولاً
            const doc = await db.collection("lectureContent").doc(currentContentId).get();
            const content = doc.data();
            
            // حذف ملف PDF من التخزين إذا كان نوع المحتوى PDF
            if (content.type === 'pdf' && content.url) {
              const fileRef = storage.refFromURL(content.url);
              await fileRef.delete();
            }
            
            // حذف المحتوى من Firestore
            await db.collection("lectureContent").doc(currentContentId).delete();
            
            // إغلاق المودال وإعادة تحميل المحتويات
            editContentModalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
              editContentModal.classList.add('hidden');
              showLectureModal(currentLectureId, 
                               modalLectureStage.textContent, 
                               modalLectureCourse.textContent, 
                               modalLectureTitle.textContent, 
                               modalLectureDescription.textContent);
            }, 300);
            
            showAlert('success', 'تم الحذف', 'تم حذف المحتوى بنجاح');
          } catch (error) {
            console.error("Error deleting content:", error);
            showAlert('error', 'خطأ في الحذف', 'حدث خطأ أثناء حذف المحتوى');
          }
        }
      );
    });

    // عرض مودال التأكيد
    function showConfirmModal(title, message, callback) {
      confirmModalTitle.textContent = title;
      confirmModalMessage.textContent = message;
      
      // إزالة أي مستمعين سابقين
      confirmAction.replaceWith(confirmAction.cloneNode(true));
      confirmCancel.replaceWith(confirmCancel.cloneNode(true));
      
      // إضافة مستمع جديد لزر التأكيد
      document.getElementById('confirmAction').addEventListener('click', () => {
        confirmModalContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => {
          confirmModal.classList.add('hidden');
          if (typeof callback === 'function') callback();
        }, 300);
      });
      
      // إضافة مستمع لزر الإلغاء
      document.getElementById('confirmCancel').addEventListener('click', () => {
        confirmModalContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => {
          confirmModal.classList.add('hidden');
        }, 300);
      });
      
      // عرض المودال
      confirmModal.classList.remove('hidden');
      setTimeout(() => {
        confirmModalContent.classList.remove('scale-95', 'opacity-0');
        confirmModalContent.classList.add('scale-100', 'opacity-100');
      }, 10);
    }

    // عرض رسالة تنبيه
    function showAlert(type, title, message) {
      const icon = type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle';
      const color = type === 'success' ? 'green' : 'red';
      
      const alertDiv = document.createElement('div');
      alertDiv.className = `fixed top-6 left-6 right-6 md:left-auto md:right-6 md:max-w-md z-50 p-4 bg-${color}-50 rounded-xl border-l-4 border-${color}-500 shadow-lg transform transition-all duration-300 translate-y-0 opacity-100`;
      alertDiv.innerHTML = `
        <div class="flex items-start">
          <div class="flex-shrink-0 text-${color}-500">
            <i class="fas ${icon} text-xl"></i>
          </div>
          <div class="mr-3 flex-1">
            <h3 class="font-bold text-${color}-800">${title}</h3>
            <p class="mt-1 text-sm text-${color}-700">${message}</p>
          </div>
          <button class="text-${color}-500 hover:text-${color}-700 alert-close">
            <i class="fas fa-times"></i>
          </button>
        </div>
      `;
      
      document.body.appendChild(alertDiv);
      
      // إخفاء الرسالة بعد 5 ثواني
      setTimeout(() => {
        alertDiv.classList.add('translate-y-[-20px]', 'opacity-0');
        setTimeout(() => alertDiv.remove(), 300);
      }, 5000);
      
      // إغلاق الرسالة عند النقر على الزر
      alertDiv.querySelector('.alert-close').addEventListener('click', () => {
        alertDiv.classList.add('translate-y-[-20px]', 'opacity-0');
        setTimeout(() => alertDiv.remove(), 300);
      });
    }

    // تحميل المحاضرات عند بدء التشغيل
    document.addEventListener('DOMContentLoaded', () => {
      loadLectures();
      
      // تعيين التبويب النشط الأول
      tabBtns[0].classList.remove('text-dark-500', 'hover:text-primary-600');
      tabBtns[0].classList.add('bg-white', 'shadow-md', 'text-primary-600');
    });
  </script>
</body>
</html>
